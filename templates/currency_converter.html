{% extends "base.html" %}

{% block title %}Currency Converter - CalcHub{% endblock %}

{% block content %}
<div class="calculator-page">
    <h1>ðŸ’± Currency Converter</h1>
    <div class="calc-container">
        <div class="input-group">
            <label>Amount</label>
            <input type="number" id="amount" placeholder="Enter amount" value="100">
        </div>
        <div class="input-group">
            <label>From Currency</label>
            <select id="fromCurrency">
                <option value="USD">USD - US Dollar</option>
                <option value="EUR">EUR - Euro</option>
                <option value="GBP">GBP - British Pound</option>
                <option value="JPY">JPY - Japanese Yen</option>
                <option value="CNY">CNY - Chinese Yuan</option>
                <option value="INR">INR - Indian Rupee</option>
                <option value="AUD">AUD - Australian Dollar</option>
                <option value="CAD">CAD - Canadian Dollar</option>
                <option value="CHF">CHF - Swiss Franc</option>
                <option value="MXN">MXN - Mexican Peso</option>
            </select>
        </div>
        <div class="input-group">
            <label>To Currency</label>
            <select id="toCurrency">
                <option value="EUR">EUR - Euro</option>
                <option value="USD">USD - US Dollar</option>
                <option value="GBP">GBP - British Pound</option>
                <option value="JPY">JPY - Japanese Yen</option>
                <option value="CNY">CNY - Chinese Yuan</option>
                <option value="INR">INR - Indian Rupee</option>
                <option value="AUD">AUD - Australian Dollar</option>
                <option value="CAD">CAD - Canadian Dollar</option>
                <option value="CHF">CHF - Swiss Franc</option>
                <option value="MXN">MXN - Mexican Peso</option>
            </select>
        </div>
        <button class="btn-primary" onclick="convertCurrency()">Convert</button>

        <div id="result" class="result-box" style="display:none;">
            <h2><span id="originalAmount"></span> <span id="fromCurr"></span> =</h2>
            <h1 style="color: #667eea; font-size: 2.5em;"><span id="convertedAmount"></span> <span id="toCurr"></span>
            </h1>
            <div class="info-card">
                <p><strong>Exchange Rate:</strong> 1 <span id="rateFrom"></span> = <span id="rate"></span> <span
                        id="rateTo"></span></p>
                <p><strong>Inverse Rate:</strong> 1 <span id="invRateTo"></span> = <span id="invRate"></span> <span
                        id="invRateFrom"></span></p>
                <p style="color: #888; font-size: 0.9em;"><strong>Last Updated:</strong> <span id="timestamp"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    async function convertCurrency() {
        const amount = document.getElementById('amount').value;
        const fromCurrency = document.getElementById('fromCurrency').value;
        const toCurrency = document.getElementById('toCurrency').value;

        if (!amount || amount <= 0) {
            alert('Please enter a valid amount');
            return;
        }

        const response = await fetch('/api/currency-converter', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ amount, from_currency: fromCurrency, to_currency: toCurrency })
        });

        const data = await response.json();

        if (data.error) {
            alert(data.error);
            return;
        }

        document.getElementById('originalAmount').textContent = data.original_amount.toFixed(2);
        document.getElementById('fromCurr').textContent = data.from_currency;
        document.getElementById('convertedAmount').textContent = data.converted_amount.toFixed(2);
        document.getElementById('toCurr').textContent = data.to_currency;
        document.getElementById('rateFrom').textContent = data.from_currency;
        document.getElementById('rate').textContent = data.exchange_rate;
        document.getElementById('rateTo').textContent = data.to_currency;
        document.getElementById('invRateTo').textContent = data.to_currency;
        document.getElementById('invRate').textContent = data.inverse_rate;
        document.getElementById('invRateFrom').textContent = data.from_currency;
        document.getElementById('timestamp').textContent = data.timestamp;
        document.getElementById('result').style.display = 'block';
    }
</script>
{% endblock %}